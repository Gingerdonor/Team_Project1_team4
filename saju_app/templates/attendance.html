{% extends "base.html" %}

{% block title %}출석 이벤트{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/attendance.css') }}">
{% endblock %}

{% block content %}
    <div class="main-header">
        <h2>{{ current_month_str }} 출석부</h2>
    </div>
    <hr class="main-divider">

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class.="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
            <br>
        {% endif %}
    {% endwith %}

    <form method="POST" class="attendance-form">
        <button type="submit" class="submit-button" {{ 'disabled' if has_checked_in_today else '' }}>
            {% if has_checked_in_today %}
                오늘 출석 완료 (✔️)
            {% else %}
                오늘 날짜 출석하기
            {% endif %}
        </button>
    </form>
    
    <table class="calendar">
        <thead>
            <tr>
                <th>월</th>
                <th>화</th>
                <th>수</th>
                <th>목</th>
                <th>금</th>
                <th>토</th>
                <th>일</th>
            </tr>
        </thead>
        <tbody>
            {% for week in calendar_weeks %}
            <tr>
                {% for day in week %}
                    
                    {% if day == 0 %}
                        <td class="empty"></td>
                    
                    {% else %}
                        <td class="{{ 'today' if day == today_day else '' }}">
                            <div class="day-number">{{ day }}</div>
                            
                            {% if day in checked_in_days %}
                                <span class="check-mark">✔️</span>
                            {% endif %}
                        </td>
                    {% endif %}
                    
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}